"use strict";var _createClass=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AjaxTree=function(){function i(e){var l=this,t=e.id,n=e.data,c=e.itemKey,a=e.isExpand,o=e.isAsync,d=e.loadNode;_classCallCheck(this,i),this.contain=document.querySelector(t),this.bindSubNode=function(e,t){e.addEventListener("click",function(e){l.subNode.prototype=t,l.subNode(e)})},this.subNode=function(e){var t=e.target.parentNode,n=l.subNode.prototype.children,a=null;if(n&&0<n.length)if("true"==t.dataset.expand){for(var r=t.getElementsByTagName("ul"),d=0;d<r.length;d++)t.removeChild(r[d]);t.dataset.expand=!1}else a=l.createunExpandListEls(n),t.appendChild(a),t.dataset.expand=!0;else t.dataset.loading="";l.lodeNode(n,t)},this.lodeNode=function(n,a){if(d&&n.length<=0){var r={label:a.querySelector("span").innerHTML,id:a.dataset.itemId,children:n};new Promise(function(e,t){d(r,e,t)}).then(function(e){a.dataset.expand=!0,delete a.dataset.loading,n.push.apply(n,_toConsumableArray(e));var t=l.createunExpandListEls(e);a.appendChild(t)}).catch(function(e){throw delete a.dataset.loading,new Error(e)})}},this.createunExpandListEls=function(e){if(e&&0<e.length){var r=document.createElement("ul");return e.forEach(function(e){var t=document.createElement("li");t.dataset.itemId=e[c.id];var n=document.createElement("span");if(n.innerHTML=e[c.label],o?e[c.children]:e[c.children]&&0<e[c.children].length){t.dataset.expand=!1;var a=document.createElement("a");l.bindSubNode(a,e),t.appendChild(a)}t.appendChild(n),r.appendChild(t)}),r}},this.createExpandedListEls=function(e){var t=l.getType(e);if("Array"==t){for(var n=document.createElement("ul"),a=0;a<e.length;a++)n.appendChild(l.createExpandedListEls(e[a]));return n}if("Object"==t){var r=document.createElement("li"),d=document.createElement("a"),i=document.createElement("span");return l.bindSubNode(d,e),i.innerHTML=e[c.label],r.dataset.itemId=e[c.id],r.appendChild(i),(o?e[c.children]:e[c.children]&&0<e[c.children].length)&&(r.dataset.expand=0<e[c.children].length,r.appendChild(d),r.appendChild(l.createExpandedListEls(e[c.children]))),r}};var r=null;r=a?this.createExpandedListEls(n):this.createunExpandListEls(n),this.contain.appendChild(r)}return _createClass(i,[{key:"getType",value:function(e){var t=Object.prototype.toString.call(e);return"[object Array]"==t?"Array":"[object Object]"==t?"Object":"param"}}]),i}();